{% extends 'base.html' %}
{% load static %}
{% block content %}

<div class="container my-5 cart-page">
  <h3 class="mb-4">ðŸ›’ Your Cart</h3>

  {% if not cart_items %}
  <div class="text-center">
    <h5>Your cart is empty</h5>
    <a href="{% url 'home' %}" class="btn btn-dark mt-3">Continue Shopping</a>
  </div>
  {% else %}
  <div class="row">
    <!-- CART ITEMS -->
    <div class="col-lg-8">
      {% for item in cart_items %}
      <div class="card mb-3 border-0 shadow-sm">
        <div class="card-body d-flex align-items-center justify-content-between">

          <div class="d-flex align-items-center">
            <img src="{{ item.product.main_image.url }}" class="cart-img rounded">
            <div class="ms-3">
              <h6 class="mb-1">{{ item.product.product_name }}</h6>
              <small class="text-muted d-block">Size: {{ item.size }}</small>
              <small class="text-muted d-block">Qty: {{ item.quantity }}</small>
            </div>
          </div>

          <div class="text-end">
            <p class="fw-bold mb-1">â‚¹ {{ item.sub_total }}</p>
            <a href="{% url 'remove_cart' item.id %}" class="remove-icon" title="Remove item">
              <i class="bi bi-trash"></i>
            </a>

          </div>

        </div>
      </div>
      {% endfor %}
    </div>

    <!-- CART TOTALS (RIGHT BOX) -->
    <div class="col-lg-4">
      <div class="cart-totals-box sticky-top">
        <h5>Cart totals</h5>

        <div class="row-line">
          <span>Subtotal</span>
          <span>â‚¹ {{ total }}</span>
        </div>

        <hr>

        <div class="row-line">
          <span>Shipping</span>
          <span>
            {% if shipping == 0 %}
            FREE
            {% else %}
            â‚¹ {{ shipping }}
            {% endif %}
          </span>
        </div>


        <div class="shipping-note">
          Shipping to Tamil Nadu.
          <a href="{% url 'checkout' %}" class="float-end">Change address</a>
        </div>

        <hr>

        <div class="row-line total-row">
          <span>Total</span>
          <span>â‚¹ {{ grand_total }}</span>
        </div>

        <button class="checkout-btn w-100 mt-4">
          
          <a href="{% url 'checkout' %}" class="checkout-btn w-100 mt-4 text-center">
            PROCEED TO CHECKOUT
          </a>

        </button>

        <p class="text-center secure-text">
          Guaranteed Safe & Secure Checkout
        </p>

        <div class="payment-icons text-center">
          <img src="{% static 'image/phonepe.png' %}">
          <img src="{% static 'image/paytm.png' %}">
          <img src="{% static 'image/gpay.png' %}">
        </div>
      </div>

    </div>
    {% endif %}
  </div>
</div>
{% endblock content %}